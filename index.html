<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shree Shyam Fast Food - Digital Menu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FF6B35',
                        secondary: '#2D3748',
                        accent: '#F7931E'
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Poppins', sans-serif; }
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .floating-animation {
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        .glow-effect {
            box-shadow: 0 0 20px rgba(255, 107, 53, 0.3);
        }
        .order-item {
            transition: all 0.3s ease;
        }
        .order-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .quantity-btn {
            transition: all 0.2s ease;
        }
        .quantity-btn:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-orange-50 via-red-50 to-yellow-50 min-h-screen">
    <!-- Header -->
    <header class="glass-effect sticky top-0 z-50 p-4 mb-6">
        <div class="container mx-auto flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <div class="w-12 h-12 bg-gradient-to-r from-primary to-accent rounded-full flex items-center justify-center floating-animation">
                    <span class="text-white font-bold text-xl">üçï</span>
                </div>
                <div>
                    <h1 class="text-2xl font-bold text-secondary">Shree Shyam Fast Food</h1>
                    <p class="text-sm text-gray-600">Pro. Ayush Chorasiya | üì± 6263015238</p>
                </div>
            </div>
            <div class="relative">
                <button onclick="openCart()" class="bg-primary text-white px-4 py-2 rounded-full flex items-center space-x-2 glow-effect hover:bg-red-600 transition-all">
                    <span>üõí</span>
                    <span id="cartCount" class="bg-white text-primary px-2 py-1 rounded-full text-sm font-bold">0</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Table Selection -->
    <div id="tableSelection" class="container mx-auto px-4 mb-8">
        <div class="bg-white rounded-2xl p-6 shadow-lg">
            <h2 class="text-xl font-bold text-secondary mb-4 text-center">ü™ë Select Your Table</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <button onclick="selectTable(1)" class="table-btn bg-gradient-to-r from-blue-400 to-blue-600 text-white p-4 rounded-xl hover:scale-105 transition-all">
                    <div class="text-2xl mb-2">ü™ë</div>
                    <div class="font-semibold">Table 1</div>
                </button>
                <button onclick="selectTable(2)" class="table-btn bg-gradient-to-r from-green-400 to-green-600 text-white p-4 rounded-xl hover:scale-105 transition-all">
                    <div class="text-2xl mb-2">ü™ë</div>
                    <div class="font-semibold">Table 2</div>
                </button>
                <button onclick="selectTable(3)" class="table-btn bg-gradient-to-r from-purple-400 to-purple-600 text-white p-4 rounded-xl hover:scale-105 transition-all">
                    <div class="text-2xl mb-2">ü™ë</div>
                    <div class="font-semibold">Table 3</div>
                </button>
                <button onclick="selectTable(4)" class="table-btn bg-gradient-to-r from-pink-400 to-pink-600 text-white p-4 rounded-xl hover:scale-105 transition-all">
                    <div class="text-2xl mb-2">ü™ë</div>
                    <div class="font-semibold">Table 4</div>
                </button>
            </div>
        </div>
    </div>

    <!-- Menu Categories -->
    <div class="container mx-auto px-4">
        <!-- Category Tabs -->
        <div class="flex overflow-x-auto space-x-2 mb-6 pb-2">
            <button onclick="showCategory('all')" class="category-tab active bg-primary text-white px-6 py-3 rounded-full whitespace-nowrap font-semibold">
                üçΩÔ∏è All Items
            </button>
            <button onclick="showCategory('starters')" class="category-tab bg-white text-secondary px-6 py-3 rounded-full whitespace-nowrap hover:bg-gray-100">
                ü•ó Starters
            </button>
            <button onclick="showCategory('burgers')" class="category-tab bg-white text-secondary px-6 py-3 rounded-full whitespace-nowrap hover:bg-gray-100">
                üçî Burgers
            </button>
            <button onclick="showCategory('pizza')" class="category-tab bg-white text-secondary px-6 py-3 rounded-full whitespace-nowrap hover:bg-gray-100">
                üçï Pizza
            </button>
            <button onclick="showCategory('beverages')" class="category-tab bg-white text-secondary px-6 py-3 rounded-full whitespace-nowrap hover:bg-gray-100">
                ü•§ Beverages
            </button>
            <button onclick="showCategory('combo')" class="category-tab bg-white text-secondary px-6 py-3 rounded-full whitespace-nowrap hover:bg-gray-100">
                üéØ Combos
            </button>
        </div>

        <!-- Menu Items Grid -->
        <div id="menuGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Menu items will be populated by JavaScript -->
        </div>
    </div>

    <!-- Cart Modal -->
    <div id="cartModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl p-6 max-w-md w-full max-h-96 overflow-y-auto">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-secondary">üõí Your Order</h3>
                    <button onclick="closeCart()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                </div>
                <div id="cartItems" class="space-y-3 mb-4">
                    <!-- Cart items will be populated here -->
                </div>
                <div class="border-t pt-4">
                    <div class="flex justify-between items-center text-lg font-bold mb-4">
                        <span>Total:</span>
                        <span id="cartTotal" class="text-primary">‚Çπ0</span>
                    </div>
                    <button onclick="proceedToCheckout()" class="w-full bg-gradient-to-r from-primary to-accent text-white py-3 rounded-xl font-semibold hover:scale-105 transition-all glow-effect">
                        üöÄ Place Order
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkoutModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl p-6 max-w-md w-full">
                <h3 class="text-xl font-bold text-secondary mb-4">üìã Order Details</h3>
                <form id="checkoutForm">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">üë§ Customer Name</label>
                            <input type="text" id="customerName" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">üì± Phone Number</label>
                            <input type="tel" id="customerPhone" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">üìß Email (Optional)</label>
                            <input type="email" id="customerEmail" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">üí≥ Payment Method</label>
                            <select id="paymentMethod" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                <option value="cash">üíµ Cash</option>
                                <option value="upi">üì± UPI</option>
                                <option value="card">üí≥ Card</option>
                            </select>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <div class="flex justify-between items-center text-lg font-bold">
                                <span>ü™ë Table:</span>
                                <span id="selectedTableDisplay">-</span>
                            </div>
                            <div class="flex justify-between items-center text-lg font-bold mt-2">
                                <span>üí∞ Total Amount:</span>
                                <span id="checkoutTotal" class="text-primary">‚Çπ0</span>
                            </div>
                        </div>
                    </div>
                    <div class="flex space-x-3 mt-6">
                        <button type="button" onclick="closeCheckout()" class="flex-1 bg-gray-300 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-400 transition-all">
                            Cancel
                        </button>
                        <button type="submit" class="flex-1 bg-gradient-to-r from-green-500 to-green-600 text-white py-3 rounded-xl font-semibold hover:scale-105 transition-all glow-effect">
                            ‚úÖ Confirm Order
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl p-8 max-w-sm w-full text-center">
                <div class="text-6xl mb-4">üéâ</div>
                <h3 class="text-2xl font-bold text-green-600 mb-2">Order Placed!</h3>
                <p class="text-gray-600 mb-4">Your order has been successfully placed. The kitchen has been notified!</p>
                <div class="bg-green-50 p-4 rounded-lg mb-4">
                    <p class="text-sm text-green-700">Order ID: <span id="orderIdDisplay" class="font-bold">#ORD001</span></p>
                    <p class="text-sm text-green-700">Estimated Time: 15-20 minutes</p>
                </div>
                <button onclick="closeSuccess()" class="w-full bg-primary text-white py-3 rounded-xl font-semibold hover:bg-red-600 transition-all">
                    Continue Browsing
                </button>
            </div>
        </div>
    </div>

    <!-- Loading Modal -->
    <div id="loadingModal" class="fixed inset-0 bg-black bg-opacity-50 z-60 hidden">
        <div class="flex items-center justify-center min-h-screen">
            <div class="bg-white rounded-2xl p-8 text-center">
                <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-primary mx-auto mb-4"></div>
                <p class="text-lg font-semibold text-gray-700">Processing your order...</p>
                <p class="text-sm text-gray-500">Please wait while we confirm your order</p>
            </div>
        </div>
    </div>

    <script>
        // Configuration - Update this with your actual Google Apps Script URL
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxQXET9ccaing-DpRc02voFJbZqAVf7T-7-rfBdiMglFH3E1PFPrbP8XWhPW9QGL-4Q/exec';

        // Menu data based on the restaurant menu
        const menuData = {
            starters: [
                { id: 1, name: "Veg Sandwich", price: 60, category: "starters", emoji: "ü•™" },
                { id: 2, name: "Cheese Veg Sandwich", price: 80, category: "starters", emoji: "üßÄ" },
                { id: 3, name: "Grilled Sandwich", price: 100, category: "starters", emoji: "üî•" },
                { id: 4, name: "Club Sandwich", price: 120, category: "starters", emoji: "üèÜ" },
                { id: 25, name: "French Fries", price: 80, category: "starters", emoji: "üçü" },
                { id: 26, name: "Masala French Fries", price: 100, category: "starters", emoji: "üçü" },
                { id: 27, name: "Cheese French Fries", price: 120, category: "starters", emoji: "üçü" },
            ],
            burgers: [
                { id: 5, name: "Aloo Tikki Burger", price: 80, category: "burgers", emoji: "üçî" },
                { id: 6, name: "Veg Burger", price: 90, category: "burgers", emoji: "üçî" },
                { id: 7, name: "Cheese Burger", price: 110, category: "burgers", emoji: "üßÄ" },
                { id: 8, name: "Double Cheese Burger", price: 130, category: "burgers", emoji: "üçî" },
            ],
            pizza: [
                { id: 9, name: "Mini Pizza", price: 80, category: "pizza", emoji: "üçï" },
                { id: 10, name: "Veg Cheese Pizza", price: 120, category: "pizza", emoji: "üçï" },
                { id: 11, name: "Margherita Pizza", price: 140, category: "pizza", emoji: "üçï" },
                { id: 12, name: "Cheese Pizza", price: 160, category: "pizza", emoji: "üßÄ" },
                { id: 13, name: "Onion Capsicum Pizza", price: 180, category: "pizza", emoji: "üçï" },
                { id: 14, name: "Paneer Pizza", price: 200, category: "pizza", emoji: "üçï" },
            ],
            beverages: [
                { id: 15, name: "Tea", price: 20, category: "beverages", emoji: "‚òï" },
                { id: 16, name: "Coffee", price: 30, category: "beverages", emoji: "‚òï" },
                { id: 17, name: "Cold Coffee", price: 60, category: "beverages", emoji: "üßä" },
                { id: 18, name: "Chocolate Shake", price: 80, category: "beverages", emoji: "ü•§" },
                { id: 19, name: "Mango Shake", price: 80, category: "beverages", emoji: "ü•≠" },
                { id: 20, name: "Vanilla Shake", price: 80, category: "beverages", emoji: "ü•§" },
            ],
            combo: [
                { id: 21, name: "Masala Maggi + French Fries + Coke", price: 120, category: "combo", emoji: "üéØ" },
                { id: 22, name: "Manchurian + Veg Noodles + Coke", price: 190, category: "combo", emoji: "üéØ" },
                { id: 23, name: "Veg Cheese Pizza + Veg Samosa + Vanilla Shake", price: 200, category: "combo", emoji: "üéØ" },
                { id: 24, name: "Masala Sandwich + Aloo Tikki Burger", price: 140, category: "combo", emoji: "üéØ" },
            ]
        };

        let cart = [];
        let selectedTable = null;
        let currentCategory = 'all';
        let itemQuantities = {};

        // Initialize the menu when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeMenu();
            setupEventListeners();
        });

        function initializeMenu() {
            showCategory('all');
        }

        function setupEventListeners() {
            // Handle form submission
            document.getElementById('checkoutForm').addEventListener('submit', handleOrderSubmission);
        }

        // Table selection
        function selectTable(tableNumber) {
            selectedTable = tableNumber;
            document.querySelectorAll('.table-btn').forEach(btn => {
                btn.classList.remove('ring-4', 'ring-yellow-400');
                // Remove existing checkmarks
                const checkmark = btn.querySelector('.absolute');
                if (checkmark) checkmark.remove();
            });
            
            const selectedBtn = event.target.closest('.table-btn');
            selectedBtn.classList.add('ring-4', 'ring-yellow-400');
            selectedBtn.style.position = 'relative';
            selectedBtn.innerHTML += '<div class="absolute top-0 right-0 bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm">‚úì</div>';
        }

        // Category functions
        function showCategory(category) {
            currentCategory = category;
            
            // Update active tab
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.classList.remove('active', 'bg-primary', 'text-white');
                tab.classList.add('bg-white', 'text-secondary');
            });
            
            // Find the clicked tab and make it active
            const activeTab = Array.from(document.querySelectorAll('.category-tab')).find(tab => 
                tab.textContent.toLowerCase().includes(category === 'all' ? 'all items' : category)
            );
            if (activeTab) {
                activeTab.classList.add('active', 'bg-primary', 'text-white');
                activeTab.classList.remove('bg-white', 'text-secondary');
            }

            // Filter and display items
            const menuGrid = document.getElementById('menuGrid');
            menuGrid.innerHTML = '';

            let itemsToShow = [];
            if (category === 'all') {
                itemsToShow = Object.values(menuData).flat();
            } else {
                itemsToShow = menuData[category] || [];
            }

            itemsToShow.forEach(item => {
                const itemCard = createMenuItemCard(item);
                menuGrid.appendChild(itemCard);
            });
        }

        // Create menu item card
        function createMenuItemCard(item) {
            const card = document.createElement('div');
            card.className = 'order-item bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all';
            card.innerHTML = `
                <div class="flex items-center justify-between mb-4">
                    <div class="text-4xl">${item.emoji}</div>
                    <div class="text-right">
                        <div class="text-xl font-bold text-primary">‚Çπ${item.price}</div>
                    </div>
                </div>
                <h3 class="text-lg font-semibold text-secondary mb-2">${item.name}</h3>
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-2">
                        <button onclick="changeQuantity(${item.id}, -1)" class="quantity-btn bg-gray-200 hover:bg-gray-300 text-gray-700 w-8 h-8 rounded-full flex items-center justify-center font-bold">-</button>
                        <span id="qty-${item.id}" class="text-lg font-semibold min-w-8 text-center">0</span>
                        <button onclick="changeQuantity(${item.id}, 1)" class="quantity-btn bg-primary hover:bg-red-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold">+</button>
                    </div>
                    <button onclick="addToCart(${item.id})" class="bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-2 rounded-full font-semibold hover:scale-105 transition-all">
                        Add to Cart
                    </button>
                </div>
            `;
            return card;
        }

        function changeQuantity(itemId, change) {
            if (!itemQuantities[itemId]) itemQuantities[itemId] = 0;
            itemQuantities[itemId] = Math.max(0, itemQuantities[itemId] + change);
            const qtyElement = document.getElementById(`qty-${itemId}`);
            if (qtyElement) {
                qtyElement.textContent = itemQuantities[itemId];
            }
        }

        function addToCart(itemId) {
            if (!selectedTable) {
                alert('ü™ë Please select a table first!');
                return;
            }

            const quantity = itemQuantities[itemId] || 1;
            if (quantity === 0) {
                itemQuantities[itemId] = 1;
                const qtyElement = document.getElementById(`qty-${itemId}`);
                if (qtyElement) qtyElement.textContent = 1;
            }

            const item = Object.values(menuData).flat().find(i => i.id === itemId);
            if (!item) return;

            const existingItem = cart.find(i => i.id === itemId);

            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                cart.push({ ...item, quantity: quantity });
            }

            updateCartUI();
            
            // Reset quantity display
            itemQuantities[itemId] = 0;
            const qtyElement = document.getElementById(`qty-${itemId}`);
            if (qtyElement) qtyElement.textContent = 0;

            // Show add animation
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = '‚úÖ Added!';
            btn.classList.add('bg-green-500');
            setTimeout(() => {
                btn.textContent = originalText;
                btn.classList.remove('bg-green-500');
            }, 1000);
        }

        function updateCartUI() {
            const cartCount = document.getElementById('cartCount');
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCount.textContent = totalItems;
            
            if (totalItems > 0) {
                cartCount.parentElement.classList.add('animate-pulse');
            } else {
                cartCount.parentElement.classList.remove('animate-pulse');
            }
        }

        function openCart() {
            if (cart.length === 0) {
                alert('üõí Your cart is empty!');
                return;
            }
            
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            
            cartItems.innerHTML = '';
            let total = 0;

            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                const cartItem = document.createElement('div');
                cartItem.className = 'flex justify-between items-center bg-gray-50 p-3 rounded-lg';
                cartItem.innerHTML = `
                    <div class="flex items-center space-x-3">
                        <span class="text-2xl">${item.emoji}</span>
                        <div>
                            <div class="font-semibold">${item.name}</div>
                            <div class="text-sm text-gray-600">‚Çπ${item.price} x ${item.quantity}</div>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="font-bold text-primary">‚Çπ${itemTotal}</span>
                        <button onclick="removeFromCart(${item.id})" class="text-red-500 hover:text-red-700 ml-2">üóëÔ∏è</button>
                    </div>
                `;
                cartItems.appendChild(cartItem);
            });

            cartTotal.textContent = `‚Çπ${total}`;
            document.getElementById('cartModal').classList.remove('hidden');
        }

        function removeFromCart(itemId) {
            cart = cart.filter(item => item.id !== itemId);
            updateCartUI();
            if (cart.length > 0) {
                openCart(); // Refresh cart display
            } else {
                closeCart();
            }
        }

        function closeCart() {
            document.getElementById('cartModal').classList.add('hidden');
        }

        function proceedToCheckout() {
            if (!selectedTable) {
                alert('ü™ë Please select a table first!');
                return;
            }
            
            closeCart();
            
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            document.getElementById('checkoutTotal').textContent = `‚Çπ${total}`;
            document.getElementById('selectedTableDisplay').textContent = `Table ${selectedTable}`;
            document.getElementById('checkoutModal').classList.remove('hidden');
        }

        function closeCheckout() {
            document.getElementById('checkoutModal').classList.add('hidden');
        }

        // Show loading modal
        function showLoading() {
            document.getElementById('loadingModal').classList.remove('hidden');
        }

        // Hide loading modal
        function hideLoading() {
            document.getElementById('loadingModal').classList.add('hidden');
        }

        // FIXED: Handle form submission
        function handleOrderSubmission(e) {
            e.preventDefault();
            
            // Show loading
            showLoading();
            
            // Validate form data first
            const customerName = document.getElementById('customerName').value.trim();
            const customerPhone = document.getElementById('customerPhone').value.trim();
            const customerEmail = document.getElementById('customerEmail').value.trim();
            const paymentMethod = document.getElementById('paymentMethod').value;
            
            // Validation
            if (!customerName || customerName.length < 2) {
                hideLoading();
                alert('Please enter a valid name (at least 2 characters).');
                return;
            }
            
            if (!customerPhone || !/^\d{10}$/.test(customerPhone)) {
                hideLoading();
                alert('Please enter a valid 10-digit phone number.');
                return;
            }
            
            if (!selectedTable) {
                hideLoading();
                alert('Please select a table.');
                return;
            }
            
            if (!cart || cart.length === 0) {
                hideLoading();
                alert('Please add items to your cart.');
                return;
            }

            // Prepare order data
            const orderData = {
                orderId: 'SS' + Date.now(),
                customerName: customerName,
                customerPhone: customerPhone,
                customerEmail: customerEmail || '',
                paymentMethod: paymentMethod,
                tableNumber: selectedTable,
                items: cart.map(item => ({
                    id: item.id,
                    name: item.name,
                    price: item.price,
                    quantity: item.quantity,
                    emoji: item.emoji
                })),
                total: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0),
                timestamp: new Date().toISOString(),
                status: 'pending'
            };

            console.log('Submitting order:', orderData);
            
            // Submit to Google Apps Script
            submitOrderToGoogleSheets(orderData)
                .then(response => {
                    console.log('Order response:', response);
                    hideLoading();
                    closeCheckout();
                    showSuccessModal(orderData.orderId);
                    
                    // Clear cart and reset form after successful order
                    cart = [];
                    selectedTable = null;
                    itemQuantities = {};
                    updateCartUI();
                    document.getElementById('checkoutForm').reset();
                    
                    // Reset table selection
                    document.querySelectorAll('.table-btn').forEach(btn => {
                        btn.classList.remove('ring-4', 'ring-yellow-400');
                        const checkmark = btn.querySelector('.absolute');
                        if (checkmark) checkmark.remove();
                    });
                })
                .catch(error => {
                    console.error('Order submission failed:', error);
                    hideLoading();
                    alert('Failed to place order. Please try again or contact staff.');
                });
        }

        // FIXED: Submit order to Google Sheets
       async function submitOrderToGoogleSheets(orderData) {
    if (!GOOGLE_SCRIPT_URL) {
        throw new Error('Google Apps Script URL not configured');
    }

    try {
        const response = await fetch(GOOGLE_SCRIPT_URL, {
            method: 'POST',
            headers: {
                'Content-Type': 'text/plain', // Change this
            },
            body: JSON.stringify(orderData)
        });

        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }

        const result = await response.json();
        
        if (!result.success) {
            throw new Error(result.message || 'Order submission failed');
        }

        return result;

    } catch (error) {
        console.error('Network error:', error);
        throw new Error('Network error: Unable to submit order');
    }
}
        // Show success modal
        function showSuccessModal(orderId) {
            document.getElementById('orderIdDisplay').textContent = orderId;
            document.getElementById('successModal').classList.remove('hidden');
        }

        // Close success modal
        function closeSuccess() {
            document.getElementById('successModal').classList.add('hidden');
        }

        // Utility function to generate random order ID
        function generateOrderId() {
            const timestamp = Date.now();
            const random = Math.floor(Math.random() * 1000);
            return `SS${timestamp}${random}`;
        }

        // Test function for debugging
        function testOrder() {
            const testOrderData = {
                orderId: generateOrderId(),
                customerName: 'Test Customer',
                customerPhone: '9999999999',
                customerEmail: 'test@example.com',
                paymentMethod: 'cash',
                tableNumber: 1,
                items: [
                    { id: 1, name: 'Veg Sandwich', price: 60, quantity: 1, emoji: 'ü•™' },
                    { id: 15, name: 'Tea', price: 20, quantity: 2, emoji: '‚òï' }
                ],
                total: 100,
                timestamp: new Date().toISOString(),
                status: 'pending'
            };

            console.log('Testing order submission...');
            submitOrderToGoogleSheets(testOrderData)
                .then(response => {
                    console.log('Test order successful:', response);
                    alert('Test order submitted successfully!');
                })
                .catch(error => {
                    console.error('Test order failed:', error);
                    alert('Test order failed: ' + error.message);
                });
        }
    </script>
</body>
</html>
