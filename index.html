<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shree Shyam Fast Food - Digital Menu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FF6B35',
                        secondary: '#2D3748',
                        accent: '#F7931E'
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Poppins', sans-serif; }
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .floating-animation {
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        .glow-effect {
            box-shadow: 0 0 20px rgba(255, 107, 53, 0.3);
        }
        .order-item {
            transition: all 0.3s ease;
        }
        .order-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .quantity-btn {
            transition: all 0.2s ease;
        }
        .quantity-btn:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-orange-50 via-red-50 to-yellow-50 min-h-screen">
    <!-- Header -->
    <header class="glass-effect sticky top-0 z-50 p-4 mb-6">
        <div class="container mx-auto flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <div class="w-12 h-12 bg-gradient-to-r from-primary to-accent rounded-full flex items-center justify-center floating-animation">
                    <span class="text-white font-bold text-xl">🍕</span>
                </div>
                <div>
                    <h1 class="text-2xl font-bold text-secondary">Shree Shyam Fast Food</h1>
                    <p class="text-sm text-gray-600">Pro. Ayush Chorasiya | 📱 6263015238</p>
                </div>
            </div>
            <div class="relative">
                <button id="cartBtn" class="bg-primary text-white px-4 py-2 rounded-full flex items-center space-x-2 glow-effect hover:bg-red-600 transition-all">
                    <span>🛒</span>
                    <span id="cartCount" class="bg-white text-primary px-2 py-1 rounded-full text-sm font-bold">0</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Table Selection -->
    <div id="tableSelection" class="container mx-auto px-4 mb-8">
        <div class="bg-white rounded-2xl p-6 shadow-lg">
            <h2 class="text-xl font-bold text-secondary mb-4 text-center">🪑 Select Your Table</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <button onclick="selectTable(1)" class="table-btn bg-gradient-to-r from-blue-400 to-blue-600 text-white p-4 rounded-xl hover:scale-105 transition-all">
                    <div class="text-2xl mb-2">🪑</div>
                    <div class="font-semibold">Table 1</div>
                </button>
                <button onclick="selectTable(2)" class="table-btn bg-gradient-to-r from-green-400 to-green-600 text-white p-4 rounded-xl hover:scale-105 transition-all">
                    <div class="text-2xl mb-2">🪑</div>
                    <div class="font-semibold">Table 2</div>
                </button>
                <button onclick="selectTable(3)" class="table-btn bg-gradient-to-r from-purple-400 to-purple-600 text-white p-4 rounded-xl hover:scale-105 transition-all">
                    <div class="text-2xl mb-2">🪑</div>
                    <div class="font-semibold">Table 3</div>
                </button>
                <button onclick="selectTable(4)" class="table-btn bg-gradient-to-r from-pink-400 to-pink-600 text-white p-4 rounded-xl hover:scale-105 transition-all">
                    <div class="text-2xl mb-2">🪑</div>
                    <div class="font-semibold">Table 4</div>
                </button>
            </div>
        </div>
    </div>

    <!-- Menu Categories -->
    <div class="container mx-auto px-4">
        <!-- Category Tabs -->
        <div class="flex overflow-x-auto space-x-2 mb-6 pb-2">
            <button onclick="showCategory('all')" class="category-tab active bg-primary text-white px-6 py-3 rounded-full whitespace-nowrap font-semibold">
                🍽️ All Items
            </button>
            <button onclick="showCategory('starters')" class="category-tab bg-white text-secondary px-6 py-3 rounded-full whitespace-nowrap hover:bg-gray-100">
                🥗 Starters
            </button>
            <button onclick="showCategory('burgers')" class="category-tab bg-white text-secondary px-6 py-3 rounded-full whitespace-nowrap hover:bg-gray-100">
                🍔 Burgers
            </button>
            <button onclick="showCategory('pizza')" class="category-tab bg-white text-secondary px-6 py-3 rounded-full whitespace-nowrap hover:bg-gray-100">
                🍕 Pizza
            </button>
            <button onclick="showCategory('beverages')" class="category-tab bg-white text-secondary px-6 py-3 rounded-full whitespace-nowrap hover:bg-gray-100">
                🥤 Beverages
            </button>
            <button onclick="showCategory('combo')" class="category-tab bg-white text-secondary px-6 py-3 rounded-full whitespace-nowrap hover:bg-gray-100">
                🎯 Combos
            </button>
        </div>

        <!-- Menu Items Grid -->
        <div id="menuGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Menu items will be populated by JavaScript -->
        </div>
    </div>

    <!-- Cart Modal -->
    <div id="cartModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl p-6 max-w-md w-full max-h-96 overflow-y-auto">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-secondary">🛒 Your Order</h3>
                    <button onclick="closeCart()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                </div>
                <div id="cartItems" class="space-y-3 mb-4">
                    <!-- Cart items will be populated here -->
                </div>
                <div class="border-t pt-4">
                    <div class="flex justify-between items-center text-lg font-bold mb-4">
                        <span>Total:</span>
                        <span id="cartTotal" class="text-primary">₹0</span>
                    </div>
                    <button onclick="proceedToCheckout()" class="w-full bg-gradient-to-r from-primary to-accent text-white py-3 rounded-xl font-semibold hover:scale-105 transition-all glow-effect">
                        🚀 Place Order
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkoutModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl p-6 max-w-md w-full">
                <h3 class="text-xl font-bold text-secondary mb-4">📋 Order Details</h3>
                <form id="checkoutForm">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">👤 Customer Name</label>
                            <input type="text" id="customerName" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">📱 Phone Number</label>
                            <input type="tel" id="customerPhone" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">💳 Payment Method</label>
                            <select id="paymentMethod" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                <option value="cash">💵 Cash</option>
                                <option value="upi">📱 UPI</option>
                                <option value="card">💳 Card</option>
                            </select>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <div class="flex justify-between items-center text-lg font-bold">
                                <span>🪑 Table:</span>
                                <span id="selectedTableDisplay">-</span>
                            </div>
                            <div class="flex justify-between items-center text-lg font-bold mt-2">
                                <span>💰 Total Amount:</span>
                                <span id="checkoutTotal" class="text-primary">₹0</span>
                            </div>
                        </div>
                    </div>
                    <div class="flex space-x-3 mt-6">
                        <button type="button" onclick="closeCheckout()" class="flex-1 bg-gray-300 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-400 transition-all">
                            Cancel
                        </button>
                        <button type="submit" class="flex-1 bg-gradient-to-r from-green-500 to-green-600 text-white py-3 rounded-xl font-semibold hover:scale-105 transition-all glow-effect">
                            ✅ Confirm Order
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl p-8 max-w-sm w-full text-center">
                <div class="text-6xl mb-4">🎉</div>
                <h3 class="text-2xl font-bold text-green-600 mb-2">Order Placed!</h3>
                <p class="text-gray-600 mb-4">Your order has been successfully placed. The kitchen has been notified!</p>
                <div class="bg-green-50 p-4 rounded-lg mb-4">
                    <p class="text-sm text-green-700">Order ID: <span id="orderIdDisplay" class="font-bold">#ORD001</span></p>
                    <p class="text-sm text-green-700">Estimated Time: 15-20 minutes</p>
                </div>
                <button onclick="closeSuccess()" class="w-full bg-primary text-white py-3 rounded-xl font-semibold hover:bg-red-600 transition-all">
                    Continue Browsing
                </button>
            </div>
        </div>
    </div>

    <script>
        // Menu data based on the restaurant menu
        const menuData = {
            starters: [
                { id: 1, name: "Veg Sandwich", price: 60, category: "starters", emoji: "🥪" },
                { id: 2, name: "Cheese Veg Sandwich", price: 80, category: "starters", emoji: "🧀" },
                { id: 3, name: "Grilled Sandwich", price: 100, category: "starters", emoji: "🔥" },
                { id: 4, name: "Club Sandwich", price: 120, category: "starters", emoji: "🏆" },
                { id: 25, name: "French Fries", price: 80, category: "starters", emoji: "🏆" },
                { id: 26, name: "Masala French Fries", price: 100, category: "starters", emoji: "🏆" },
                { id: 27, name: "Cheese French Fries", price: 120, category: "starters", emoji: "🏆" },
            ],
            burgers: [
                { id: 5, name: "Aloo Tikki Burger", price: 80, category: "burgers", emoji: "🍔" },
                { id: 6, name: "Veg Burger", price: 90, category: "burgers", emoji: "🍔" },
                { id: 7, name: "Cheese Burger", price: 110, category: "burgers", emoji: "🧀" },
                { id: 8, name: "Double Cheese Burger", price: 130, category: "burgers", emoji: "🍔" },
            ],
            pizza: [
                { id: 9, name: "Mini Pizza", price: 80, category: "pizza", emoji: "🍕" },
                { id: 10, name: "Veg Cheese Pizza", price: 120, category: "pizza", emoji: "🍕" },
                { id: 11, name: "Margherita Pizza", price: 140, category: "pizza", emoji: "🍕" },
                { id: 12, name: "Cheese Pizza", price: 160, category: "pizza", emoji: "🧀" },
                { id: 13, name: "Onion Capsicum Pizza", price: 180, category: "pizza", emoji: "🍕" },
                { id: 14, name: "Paneer Pizza", price: 200, category: "pizza", emoji: "🍕" },
            ],
            beverages: [
                { id: 15, name: "Tea", price: 20, category: "beverages", emoji: "☕" },
                { id: 16, name: "Coffee", price: 30, category: "beverages", emoji: "☕" },
                { id: 17, name: "Cold Coffee", price: 60, category: "beverages", emoji: "🧊" },
                { id: 18, name: "Chocolate Shake", price: 80, category: "beverages", emoji: "🥤" },
                { id: 19, name: "Mango Shake", price: 80, category: "beverages", emoji: "🥭" },
                { id: 20, name: "Vanilla Shake", price: 80, category: "beverages", emoji: "🥤" },
            ],
            combo: [
                { id: 21, name: "Masala Maggi + French Fries + Coke", price: 120, category: "combo", emoji: "🎯" },
                { id: 22, name: "Manchurian + Veg Noodles + Coke", price: 190, category: "combo", emoji: "🎯" },
                { id: 23, name: "Veg Cheese Pizza + Veg Samosa + Vanilla sake", price: 200, category: "combo", emoji: "🎯" },
                { id: 24, name: "Masala Sandwich + Aloo Tikki Burger", price: 140, category: "combo", emoji: "🎯" },
            ]
        };

        let cart = [];
        let selectedTable = null;
        let currentCategory = 'all';

        // Initialize the menu
        function initializeMenu() {
            showCategory('all');
        }

        // Table selection
        function selectTable(tableNumber) {
            selectedTable = tableNumber;
            document.querySelectorAll('.table-btn').forEach(btn => {
                btn.classList.remove('ring-4', 'ring-yellow-400');
            });
            event.target.closest('.table-btn').classList.add('ring-4', 'ring-yellow-400');
            
            // Show success animation
            const btn = event.target.closest('.table-btn');
            btn.innerHTML += '<div class="absolute top-0 right-0 bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm">✓</div>';
            btn.style.position = 'relative';
        }

        // Category functions
        function showCategory(category) {
            currentCategory = category;
            
            // Update active tab
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.classList.remove('active', 'bg-primary', 'text-white');
                tab.classList.add('bg-white', 'text-secondary');
            });
            event.target.classList.add('active', 'bg-primary', 'text-white');
            event.target.classList.remove('bg-white', 'text-secondary');

            // Filter and display items
            const menuGrid = document.getElementById('menuGrid');
            menuGrid.innerHTML = '';

            let itemsToShow = [];
            if (category === 'all') {
                itemsToShow = Object.values(menuData).flat();
            } else {
                itemsToShow = menuData[category] || [];
            }

            itemsToShow.forEach(item => {
                const itemCard = createMenuItemCard(item);
                menuGrid.appendChild(itemCard);
            });
        }

        // Create menu item card
        function createMenuItemCard(item) {
            const card = document.createElement('div');
            card.className = 'order-item bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all';
            card.innerHTML = `
                <div class="flex items-center justify-between mb-4">
                    <div class="text-4xl">${item.emoji}</div>
                    <div class="text-right">
                        <div class="text-xl font-bold text-primary">₹${item.price}</div>
                    </div>
                </div>
                <h3 class="text-lg font-semibold text-secondary mb-2">${item.name}</h3>
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-2">
                        <button onclick="changeQuantity(${item.id}, -1)" class="quantity-btn bg-gray-200 hover:bg-gray-300 text-gray-700 w-8 h-8 rounded-full flex items-center justify-center font-bold">-</button>
                        <span id="qty-${item.id}" class="text-lg font-semibold min-w-8 text-center">0</span>
                        <button onclick="changeQuantity(${item.id}, 1)" class="quantity-btn bg-primary hover:bg-red-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold">+</button>
                    </div>
                    <button onclick="addToCart(${item.id})" class="bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-2 rounded-full font-semibold hover:scale-105 transition-all">
                        Add to Cart
                    </button>
                </div>
            `;
            return card;
        }

        let itemQuantities = {};

        function changeQuantity(itemId, change) {
            if (!itemQuantities[itemId]) itemQuantities[itemId] = 0;
            itemQuantities[itemId] = Math.max(0, itemQuantities[itemId] + change);
            document.getElementById(`qty-${itemId}`).textContent = itemQuantities[itemId];
        }

        function addToCart(itemId) {
            if (!selectedTable) {
                alert('🪑 Please select a table first!');
                return;
            }

            const quantity = itemQuantities[itemId] || 1;
            if (quantity === 0) {
                itemQuantities[itemId] = 1;
                document.getElementById(`qty-${itemId}`).textContent = 1;
            }

            const item = Object.values(menuData).flat().find(i => i.id === itemId);
            const existingItem = cart.find(i => i.id === itemId);

            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                cart.push({ ...item, quantity: quantity });
            }

            updateCartUI();
            
            // Reset quantity display
            itemQuantities[itemId] = 0;
            document.getElementById(`qty-${itemId}`).textContent = 0;

            // Show add animation
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = '✅ Added!';
            btn.classList.add('bg-green-500');
            setTimeout(() => {
                btn.textContent = originalText;
                btn.classList.remove('bg-green-500');
            }, 1000);
        }

        function updateCartUI() {
            const cartCount = document.getElementById('cartCount');
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCount.textContent = totalItems;
            
            if (totalItems > 0) {
                cartCount.parentElement.classList.add('animate-pulse');
            } else {
                cartCount.parentElement.classList.remove('animate-pulse');
            }
        }

        function openCart() {
            if (cart.length === 0) {
                alert('🛒 Your cart is empty!');
                return;
            }
            
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            
            cartItems.innerHTML = '';
            let total = 0;

            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                const cartItem = document.createElement('div');
                cartItem.className = 'flex justify-between items-center bg-gray-50 p-3 rounded-lg';
                cartItem.innerHTML = `
                    <div class="flex items-center space-x-3">
                        <span class="text-2xl">${item.emoji}</span>
                        <div>
                            <div class="font-semibold">${item.name}</div>
                            <div class="text-sm text-gray-600">₹${item.price} x ${item.quantity}</div>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="font-bold text-primary">₹${itemTotal}</span>
                        <button onclick="removeFromCart(${item.id})" class="text-red-500 hover:text-red-700 ml-2">🗑️</button>
                    </div>
                `;
                cartItems.appendChild(cartItem);
            });

            cartTotal.textContent = `₹${total}`;
            document.getElementById('cartModal').classList.remove('hidden');
        }

        function removeFromCart(itemId) {
            cart = cart.filter(item => item.id !== itemId);
            updateCartUI();
            openCart(); // Refresh cart display
        }

        function closeCart() {
            document.getElementById('cartModal').classList.add('hidden');
        }

        function proceedToCheckout() {
            if (!selectedTable) {
                alert('🪑 Please select a table first!');
                return;
            }
            
            closeCart();
            
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            document.getElementById('checkoutTotal').textContent = `₹${total}`;
            document.getElementById('selectedTableDisplay').textContent = `Table ${selectedTable}`;
            document.getElementById('checkoutModal').classList.remove('hidden');
        }

        function closeCheckout() {
            document.getElementById('checkoutModal').classList.add('hidden');
        }

        // Handle form submission
        // Fixed frontend JavaScript code with improved error handling and CORS support

// Handle form submission with better error handling
document.getElementById('checkoutForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    // Show loading state
    const submitBtn = document.querySelector('#checkoutForm button[type="submit"]');
    const originalText = submitBtn.textContent;
    submitBtn.textContent = '⏳ Processing...';
    submitBtn.disabled = true;
    
    const orderData = {
        orderId: 'SS' + Date.now(),
        customerName: document.getElementById('customerName').value.trim(),
        customerPhone: document.getElementById('customerPhone').value.trim(),
        paymentMethod: document.getElementById('paymentMethod').value,
        tableNumber: selectedTable,
        items: cart.map(item => ({
            id: item.id,
            name: item.name,
            price: item.price,
            quantity: item.quantity,
            emoji: item.emoji
        })),
        total: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0),
        timestamp: new Date().toISOString(),
        status: 'pending'
    };

    // Validate order data before sending
    if (!validateOrderData(orderData)) {
        alert('Please fill in all required fields correctly.');
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;
        return;
    }

    console.log('Submitting order:', orderData);
    
    // Submit to Google Apps Script
    submitOrderToGoogleSheets(orderData)
        .then(response => {
            console.log('Order response:', response);
            closeCheckout();
            showSuccessModal(orderData.orderId);
        })
        .catch(error => {
            console.error('Order submission error:', error);
            alert('Failed to place order. Please try again or contact staff.');
        })
        .finally(() => {
            // Reset button state
            submitBtn.textContent = originalText;
            submitBtn.disabled = false;
        });
});

// Validate order data on frontend
function validateOrderData(orderData) {
    if (!orderData.customerName || orderData.customerName.length < 2) {
        alert('Please enter a valid name (at least 2 characters).');
        return false;
    }
    
    if (!orderData.customerPhone || !/^\d{10}$/.test(orderData.customerPhone)) {
        alert('Please enter a valid 10-digit phone number.');
        return false;
    }
    
    if (!orderData.tableNumber || orderData.tableNumber < 1) {
        alert('Please select a table.');
        return false;
    }
    
    if (!orderData.items || orderData.items.length === 0) {
        alert('Please add items to your cart.');
        return false;
    }
    
    if (!orderData.total || orderData.total <= 0) {
        alert('Invalid order total.');
        return false;
    }
    
    return true;
}

// Improved Google Apps Script submission function
async function submitOrderToGoogleSheets(orderData) {
    // Google Apps Script Web App URL - Update this with your deployed script URL
    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyrMs3RP6V_rXGF9-rGOFS-kQ__hxsTVB6ZTrsaMcqVXdl5zMy18BdcEnIC25bwi2Jv5w/exec';
    
    try {
        console.log('Sending order to:', GOOGLE_SCRIPT_URL);
        console.log('Order data:', JSON.stringify(orderData, null, 2));
        
        const response = await fetch(GOOGLE_SCRIPT_URL, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(orderData),
            mode: 'cors', // Explicitly set CORS mode
        });
        
        console.log('Response status:', response.status);
        console.log('Response headers:', response.headers);
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const result = await response.json();
        console.log('Response data:', result);
        
        if (!result.success) {
            throw new Error(result.message || 'Order submission failed');
        }
        
        return result;
        
    } catch (error) {
        console.error('Error details:', error);
        
        // Provide more specific error messages
        if (error.name === 'TypeError' && error.message.includes('Failed to fetch')) {
            throw new Error('Network error: Please check your internet connection and try again.');
        } else if (error.message.includes('CORS')) {
            throw new Error('Server configuration error. Please contact support.');
        } else {
            throw new Error(`Order submission failed: ${error.message}`);
        }
    }
}

// Alternative method using XMLHttpRequest (fallback for older browsers)
function submitOrderToGoogleSheetsXHR(orderData) {
    return new Promise((resolve, reject) => {
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyrMs3RP6V_rXGF9-rGOFS-kQ__hxsTVB6ZTrsaMcqVXdl5zMy18BdcEnIC25bwi2Jv5w/exec';
        
        const xhr = new XMLHttpRequest();
        xhr.open('POST', GOOGLE_SCRIPT_URL, true);
        xhr.setRequestHeader('Content-Type', 'application/json');
        
        xhr.onreadystatechange = function() {
            if (xhr.readyState === 4) {
                if (xhr.status === 200) {
                    try {
                        const result = JSON.parse(xhr.responseText);
                        if (result.success) {
                            resolve(result);
                        } else {
                            reject(new Error(result.message || 'Order submission failed'));
                        }
                    } catch (parseError) {
                        reject(new Error('Invalid response from server'));
                    }
                } else {
                    reject(new Error(`Server error: ${xhr.status}`));
                }
            }
        };
        
        xhr.onerror = function() {
            reject(new Error('Network error occurred'));
        };
        
        xhr.ontimeout = function() {
            reject(new Error('Request timeout'));
        };
        
        xhr.timeout = 30000; // 30 second timeout
        
        try {
            xhr.send(JSON.stringify(orderData));
        } catch (error) {
            reject(new Error('Failed to send request'));
        }
    });
}

// Test function to check if the backend is working
async function testBackendConnection() {
    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyrMs3RP6V_rXGF9-rGOFS-kQ__hxsTVB6ZTrsaMcqVXdl5zMy18BdcEnIC25bwi2Jv5w/exec';
    
    try {
        console.log('Testing backend connection...');
        
        const response = await fetch(GOOGLE_SCRIPT_URL, {
            method: 'GET',
            mode: 'cors'
        });
        
        if (response.ok) {
            const result = await response.json();
            console.log('✅ Backend connection successful:', result);
            return true;
        } else {
            console.error('❌ Backend connection failed:', response.status);
            return false;
        }
    } catch (error) {
        console.error('❌ Backend connection error:', error);
        return false;
    }
}

// Call test function on page load (optional - for debugging)
document.addEventListener('DOMContentLoaded', function() {
    initializeMenu();
    
    // Uncomment the line below to test backend connection on page load
    // testBackendConnection();
});
    </script>
</body>
</html>
